# Simulation

This package contains nodes and launch files related to simulation.

## `simple_sim.py`

This simulator is for evaluating planning and control in isolation. (i.e. without sensing, perception, localisation). It is designed to run on low powered devices without a GPU, or even on a headless server. This complements a more full-featured simulator such as CARLA.

| Input | Output |
| ----- | ------ |
| An SDControl message, on the `/sd_control` topic, that is generated by the StreetDrone [SD-VehicleInterface](https://github.com/Monash-Connected-Autonomous-Vehicle/SD-VehicleInterface) (which itself accepts TwistStamped messages as input). This message has torque percentage and steering angle percentage fields. This represents the command that would be sent to the vehicle over the CAN bus. | A transformation between the `base_link` and `map` frames, published to the `/tf` topic. On the real vehicle, this is normally the output of the localisation / odometry package (e.g. the kiss-icp package).|



Example run of the simple_sim on some waypoints:

<div align="center">
  <video src="https://user-images.githubusercontent.com/7232997/232418101-990ed2fb-cd00-43ed-8db4-1d363a6e28c3.mov" alt="Example run of the simple_sim on some waypoints" width="400" />
</div>






To run:
```
. ~/mcav_ws/install/setup.bash
ros2 launch simulation simple_sim.launch.xml waypoints_file:=/home/mcav/mcav_ws/src/mcav_autonomy/simulation/example_waypoints/straight.csv
```

## `twist_stamp_remover.py`

This is a small node that accepts a [TwistStamped](https://github.com/ros2/common_interfaces/blob/humble/geometry_msgs/msg/TwistStamped.msg) message, and republishes the same values in a [Twist](https://github.com/ros2/common_interfaces/blob/humble/geometry_msgs/msg/Twist.msg) message, without the stamp. This allows for interoperability of our stack that uses TwistStamped messages (SD-VehicleInterface, pure_pursuit, and simple_sim), with CARLA and gazebo, which use Twist messages.

Input and output topics can be specified using "remap" tags when including the node in a launch file. For example usage, see `twist_stamp_remover.launch.xml`.
